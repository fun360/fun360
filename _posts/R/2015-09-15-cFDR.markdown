---
layout: post
title:  "cFDR公式推导"
date:   2015-09-15 22:13:00
author: 吴珂皓
categories: r
keywords: SKAT, SNP, R语言, 罕见变异, Rare variant
excerpt: 解读SKAT源代码
---

原文请见[链接](https://github.com/KehaoWu/cFDR-common-controls/blob/master/journal.pgen.1004926.pdf)

$$原文中描述的cFDR(p_{i}|p_{j}) 为P_{i}和P_{j}在同时分别小于同一对p_{i}，p_{i}情况下的{H_{0}}^{i}成立的概率。$$

#### 关键在于如何推导以下公式：

$$Pr({H_{0}}^{i}|P_{i}<p_{i},P_{j}<p_{j}) = Pr({H_{0}}^{i}|P_{j}<p_{j})\frac{Pr(P_{i}<p_{i}|P_{j}<p_{j},{H_{0}}^{i})}{Pr(P_{i}<p_{i}|P_{j}<p_{j})}$$

#### 现推导过程如下：

$$Pr({H_{0}}^{i}|P_{i}<p_{i},P_{j}<p_{j}) = Pr({H_{0}}^{i}|P_{j}<p_{j})\frac{Pr(P_{i}<p_{i}|P_{j}<p_{j},{H_{0}}^{i})Pr(P_{j}<p_{j})}{Pr(P_{i}<p_{i}|P_{j}<p_{j})Pr(P_{j}<p_{j})}$$

$$Pr({H_{0}}^{i}|P_{i}<p_{i},P_{j}<p_{j}) = \frac{Pr(P_{i}<p_{i}|P_{j}<p_{j},{H_{0}}^{i})Pr({H_{0}}^{i}|P_{j}<p_{j})Pr(P_{j}<p_{j})}{Pr(P_{i}<p_{i}|P_{j}<p_{j})Pr(P_{j}<p_{j})}$$

$$Pr({H_{0}}^{i}|P_{i}<p_{i},P_{j}<p_{j}) = \frac{Pr(P_{i}<p_{i}|P_{j}<p_{j},{H_{0}}^{i})Pr({H_{0}}^{i},P_{j}<p_{j})}{Pr(P_{i}<p_{i},P_{j}<p_{j})}$$

$$Pr({H_{0}}^{i}|P_{i}<p_{i},P_{j}<p_{j}) = \frac{Pr(P_{i}<p_{i},P_{j}<p_{j},{H_{0}}^{i})}{Pr(P_{i}<p_{i},P_{j}<p_{j})}$$

$$Pr({H_{0}}^{i}|P_{i}<p_{i},P_{j}<p_{j})Pr(P_{i}<p_{i},P_{j}<p_{j}) = Pr(P_{i}<p_{i},P_{j}<p_{j},{H_{0}}^{i})$$

$$Pr({H_{0}}^{i},P_{i}<p_{i},P_{j}<p_{j}) = Pr(P_{i}<p_{i},P_{j}<p_{j},{H_{0}}^{i})$$
